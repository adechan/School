#1
SELECT an, COUNT(*)
FROM studenti 
GROUP BY an;

#2
SELECT an, grupa, COUNT(*)
FROM studenti 
GROUP BY an, grupa
ORDER BY an ASC, grupa ASC;

#3
SELECT an, grupa, COUNT(*)
FROM studenti
WHERE bursa IS NOT NULL
GROUP BY an, grupa;

#4
SELECT SUM(bursa) FROM studenti;

#5 (??)
SELECT AVG(NVL(bursa, 0)) FROM studenti; 

#6
SELECT valoare, COUNT(*) 
FROM note
GROUP BY valoare
ORDER BY valoare desc;

#7
SELECT TO_CHAR(data_notare, 'Day', 'NLS_DATE_LANGUAGE=english'), COUNT(valoare)
FROM note
GROUP BY TO_CHAR(data_notare, 'Day', 'NLS_DATE_LANGUAGE=english')
ORDER BY 2 desc;

#8
SELECT TO_CHAR(data_notare, 'Day', 'NLS_DATE_LANGUAGE=english'), COUNT(valoare)
FROM note
GROUP BY TO_CHAR(data_notare, 'Day', 'NLS_DATE_LANGUAGE=english'), TO_CHAR(data_notare, 'D', 'NLS_DATE_LANGUAGE=english')
ORDER BY TO_CHAR(data_notare, 'D', 'NLS_DATE_LANGUAGE=english') ASC;

#9
SELECT s.nr_matricol, s.nume, s.prenume, AVG(n.valoare)
FROM studenti s 
JOIN note n ON s.nr_matricol = n.nr_matricol
GROUP BY s.nr_matricol, s.nume, s.prenume
ORDER BY 4 DESC;

#10 (??)
SELECT s.nr_matricol, s.nume, s.prenume, AVG(n.valoare)
FROM studenti s 
LEFT JOIN note n ON s.nr_matricol = n.nr_matricol
GROUP BY s.nr_matricol, s.nume, s.prenume
ORDER BY 4 DESC;

#11
SELECT s.nr_matricol, s.nume, s.prenume, NVL(AVG(n.valoare), 0)
FROM studenti s 
LEFT JOIN note n ON s.nr_matricol = n.nr_matricol
GROUP BY s.nr_matricol, s.nume, s.prenume
ORDER BY 4 DESC;

#12
SELECT s.nr_matricol, s.nume, s.prenume, NVL(AVG(n.valoare), 0)
FROM studenti s 
LEFT JOIN note n ON s.nr_matricol = n.nr_matricol
GROUP BY s.nr_matricol, s.nume, s.prenume
HAVING NVL(AVG(n.valoare), 0) >= 8
ORDER BY 4 DESC;

#13 (!??)
SELECT s.nr_matricol, MAX(n.valoare), MIN(n.valoare), AVG(n.valoare)
FROM studenti s 
JOIN note n ON s.nr_matricol = n.nr_matricol AND n.valoare >= 7
GROUP BY s.nr_matricol
MINUS
SELECT s.nr_matricol, MAX(n.valoare), MIN(n.valoare), AVG(n.valoare)
FROM studenti s 
JOIN note n ON s.nr_matricol = n.nr_matricol AND n.valoare < 7
GROUP BY s.nr_matricol;

#14


#15
SELECT s.nume, s.prenume, AVG(n.valoare)
FROM studenti s 
JOIN note n ON s.nr_matricol = n.nr_matricol
WHERE s.an = 3 AND s.grupa = 'A2'
GROUP BY s.nume, s.prenume;

#16


#17
SELECT c.titlu_curs, NVL(MIN(n.valoare), 0), NVL(MAX(n.valoare), 0)
FROM cursuri c 
LEFT JOIN note n ON c.id_curs = n.id_curs
GROUP BY c.titlu_curs;
